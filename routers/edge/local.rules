# IDS Rules

alert tcp 10.20.10.0/24 any -> 10.20.30.0/24 1:65535 (flags:S; msg:"[IDS] Possible SYN Scan Detected"; threshold:type both, track by_src, count 20, seconds 5; sid:100001; rev:1;)
alert tcp 10.20.10.0/24 any -> 10.20.20.0/24 22 (msg:"[IDS] SSH Brute Force Attempt"; flags:S; threshold: type both, track by_src, count 5, seconds 30; sid:1000002; rev:2;)
alert http 10.20.30.0/24 any -> 10.20.10.0/24 any (msg:"[IDS] File Download Detected (Binary/Octet-Stream)"; flow:from_server,established; content:"200"; http_stat_code; content:"application/octet-stream"; http_header; classtype:policy-violation; sid:1000005; rev:1;)

# IPS Rules

drop tcp 10.20.10.0/24 any -> 10.20.40.0/24 any (msg:"[IPS] DROP Port Scanning Detection"; flags:S; flow:stateless; threshold: type both, track by_src, count 10, seconds 10; classtype:attempted-recon; sid:2000001; rev:1;)
drop tcp 10.20.10.0/24 any -> 10.20.40.0/24 22 (msg:"[IPS] DROP SSH Brute Force"; flags:S; threshold: type both, track by_src, count 3, seconds 30; classtype:suspicious-login; sid:2000002; rev:1;)
drop http 10.20.10.0/24 any -> 10.20.20.0/24 any (msg:"[IPS] DROP HTTP POST/Upload Attempt"; flow:to_server,established; content:"POST"; http_method; classtype:web-application-attack; sid:2000003; rev:1;)