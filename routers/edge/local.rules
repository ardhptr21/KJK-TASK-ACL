# IDS Rules

alert tcp 10.20.10.0/24 any -> 10.20.30.0/24 1:65535 (flags:S; msg:"[IDS] Possible SYN Scan from Mahasiswa to Riset"; threshold:type both, track by_src, count 20, seconds 5; sid:100001; rev:1;)
alert tcp 10.20.10.0/24 any -> 10.20.20.0/24 22 (msg:"[IDS] SSH Brute Force Attempt"; flags:S; threshold: type both, track by_src, count 5, seconds 30; sid:1000002; rev:2;)
alert http 10.20.30.0/24 any -> 10.20.10.0/24 any (msg:"[IDS] File Download Detected (Binary/Octet-Stream)"; flow:from_server,established; content:"200"; http_stat_code; content:"application/octet-stream"; http_header; classtype:policy-violation; sid:1000005; rev:1;)

# IPS Rules

# mahasiswa -> admin
drop tcp 10.20.10.0/24 any -> 10.20.40.0/24 1:65535 (flags:S; msg:"[IPS] Blocked SYN Scan from Mahasiswa to Admin"; threshold:type both, track by_src, count 20, seconds 5; sid:200001; rev:1;)
# any -> admin
drop tcp 0.0.0.0/0 any -> 10.20.40.20 22 (msg:"[IPS] SSH Brute Force Blocked to Admin"; flow:to_server, established; content:"SSH-"; depth:4; threshold:type both, track by_src, count 6, seconds 60; sid:200002; rev:1;)
# mahasiswa -> akademik
drop http 10.20.10.0/24 any -> 10.20.20.15 any (msg:"[IPS] Suspicious HTTP File Upload Blocked"; flow:to_server, established; content:"POST"; http_method; file_data; dsize:>200; sid:200003; rev:1;)
